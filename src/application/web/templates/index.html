<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>describe_me — Live</title>
  <style nonce="__CSP_NONCE__">
__INLINE_CSS__
  </style>
</head>
<body>
  <header>
    <div id="statusDot" class="dot"></div>
    <h1>describe_me — informations en direct</h1>
    <span class="badge" id="lastUpdate">—</span>
  </header>

  <main>
    <div class="grid">
      <section class="card">
        <h2>Système</h2>
        <div class="row"><span class="k">Hostname</span><span class="v" id="hostname">—</span></div>
        <div class="row"><span class="k">OS</span><span class="v" id="os">—</span></div>
        <div class="row"><span class="k">Kernel</span><span class="v" id="kernel">—</span></div>
        <div class="row"><span class="k">Uptime</span><span class="v" id="uptime">—</span></div>
        <div class="row"><span class="k">CPU(s)</span><span class="v" id="cpus">—</span></div>
      </section>

      <section class="card" id="updatesCard" style="display:none">
        <div class="card-header">
          <h2>Mises à jour</h2>
          <div class="card-actions">
            <a href="/updates" class="link-button small" id="updatesDetailsPage">Page dédiée</a>
            <button type="button" id="updatesDetailsToggle" class="link-button small" style="display:none">Détails</button>
          </div>
        </div>
        <div class="row"><span class="k">En attente</span><span class="v" id="updatesPending">—</span></div>
        <div class="row"><span class="k">Redémarrage</span><span class="v" id="updatesReboot">—</span></div>
        <div class="row"><span class="k">Statut</span><span class="v" id="updatesStatus">—</span></div>
        <div class="updates-details collapsed" id="updatesDetails">
          <div class="services-list updates-list" id="updatesList">
            <div class="service-empty">—</div>
          </div>
        </div>
      </section>

      <section class="card">
        <h2>Mémoire</h2>
        <div class="row"><span class="k">Total</span><span class="v" id="memTotal">—</span></div>
        <div class="row"><span class="k">Utilisée</span><span class="v" id="memUsed">—</span></div>
      </section>

      <section class="card">
        <h2>Disque</h2>
        <div class="row"><span class="k">Total</span><span class="v" id="diskTotal">—</span></div>
        <div class="row"><span class="k">Libre</span><span class="v" id="diskAvail">—</span></div>
        <div class="line">
          <div class="bar"><span id="diskBar" style="width:0%"></span></div>
        </div>
        <div class="mono" id="partitions">—</div>
      </section>

      <section class="card" id="networkCard" style="display:none">
        <h2>Trafic reseau</h2>
        <div class="network-grid" id="networkList">
          <div class="service-empty">—</div>
        </div>
      </section>
    </div>

    <section class="card" id="servicesCard" style="display:none">
      <h2>Services actifs</h2>
      <div class="services-list" id="servicesList">
        <div class="service-empty">—</div>
      </div>
    </section>

    <div class="grid" id="socketsGrid" style="display:none">
      <section class="card" id="socketsTcpCard">
        <h2>Ports TCP en écoute</h2>
        <div class="services-list" id="socketsTcp">
          <div class="service-empty">—</div>
        </div>
      </section>
      <section class="card" id="socketsUdpCard">
        <h2>Ports UDP en écoute</h2>
        <div class="services-list" id="socketsUdp">
          <div class="service-empty">—</div>
        </div>
      </section>
    </div>

    <section class="card" id="rawCard" style="display:none">
      <div class="card-header">
        <h2>JSON brut</h2>
        <button type="button" id="rawToggle" class="link-button small">Masquer</button>
      </div>
      <div id="rawBody">
        <pre class="mono" id="raw">—</pre>
        <div id="error" class="error mono"></div>
      </div>
    </section>
  </main>
  <div id="tokenOverlay" class="token-overlay">
    <div class="token-dialog">
      <h2>Jeton requis</h2>
      <p>Ce serveur nécessite un jeton pour accéder aux métriques en direct.</p>
      <form id="tokenForm">
        <input id="tokenInput" type="password" placeholder="Jeton d'accès" autocomplete="off" />
        <div class="actions">
          <button type="submit">Valider</button>
          <button type="button" id="tokenForget" class="secondary">Effacer</button>
        </div>
      </form>
      <div id="tokenError" class="token-error" role="alert"></div>
    </div>
  </div>
  <div class="footer">
    Actualisation en direct via SSE (stream fetch) • Pas de framework frontend •
    <button id="tokenOpen" class="link-button" type="button">Modifier le jeton</button>
  </div>

  <script nonce="__CSP_NONCE__">
__MAIN_JS__
  </script>
</body>
</html>
